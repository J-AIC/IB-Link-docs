<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>API Reference</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script type="module" src="https://unpkg.com/@stoplight/elements/web-components.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/@stoplight/elements/styles.min.css" />
  <style>
    body{margin:0}
    header{display:flex;gap:12px;align-items:center;padding:12px;border-bottom:1px solid #eee;justify-content:space-between}
    .left{display:flex;gap:12px;align-items:center}
    .right{display:flex;gap:16px;align-items:center}
    .lang{display:flex;gap:8px;align-items:center}
    .flag{display:flex;gap:6px;align-items:center;line-height:1;background:#f9fafb;border:1px solid #e5e7eb;border-radius:8px;padding:6px 8px;cursor:pointer}
    .flag svg{display:block;width:20px;height:14px}
    .flag .label{font-size:12px;color:#111827}
    .flag.active{border-color:#3b82f6;box-shadow:0 0 0 2px rgba(59,130,246,.15)}
    .link{color:#111827;text-decoration:none;border:1px solid #e5e7eb;border-radius:8px;padding:6px 10px;background:#fff}
    .btn{display:flex;gap:8px;align-items:center;font-weight:600}
    .btn .ico svg{width:16px;height:16px;display:block}
    .link:hover{background:#f9fafb}
    main{height:calc(100vh - 50px)}
  </style>
  <!-- Elements は静的HTMLに直接埋め込み可能な Web Component です -->
</head>
<body>
  <header>
    <div class="left">
      <strong>API Reference</strong>
    </div>
    <div class="right">
      <a class="link btn" href="../index.html" title="マニュアル">
        <span class="ico">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M4 5.5C4 4.67 4.67 4 5.5 4H12v16H5.5A1.5 1.5 0 0 1 4 18.5v-13Z" stroke="#1f2937" stroke-width="1.5"/>
            <path d="M12 4h6.5c.83 0 1.5.67 1.5 1.5v13c0 .83-.67 1.5-1.5 1.5H12V4Z" stroke="#1f2937" stroke-width="1.5"/>
          </svg>
        </span>
        <span>マニュアル</span>
      </a>
      <a class="link btn" href="../installer/index.html" title="インストーラー">
        <span class="ico">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 2L2 7v10c0 5.5 3.8 10.7 10 12 6.2-1.3 10-6.5 10-12V7l-10-5z" stroke="#1f2937" stroke-width="1.5" stroke-linejoin="round"/>
            <path d="M9 12l2 2 4-4" stroke="#1f2937" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
        <span>インストーラー</span>
      </a>
      <div class="lang" id="lang">
        <button class="flag" data-lang="ja" aria-label="日本語" title="日本語">
          <svg viewBox="0 0 60 40" aria-hidden="true">
            <rect width="60" height="40" fill="#fff"/>
            <circle cx="30" cy="20" r="12" fill="#bc002d"/>
          </svg>
          <span class="label">日本語</span>
        </button>
        <button class="flag" data-lang="en" aria-label="English" title="English">
          <svg viewBox="0 0 60 40" aria-hidden="true">
            <rect width="60" height="40" fill="#b22234"/>
            <g fill="#fff">
              <rect y="4" width="60" height="4"/>
              <rect y="12" width="60" height="4"/>
              <rect y="20" width="60" height="4"/>
              <rect y="28" width="60" height="4"/>
              <rect y="36" width="60" height="4"/>
            </g>
            <rect width="27" height="21" fill="#3c3b6e"/>
          </svg>
          <span class="label">English</span>
        </button>
      </div>
    </div>
  </header>
  <main>
    <elements-api id="api" apiDescriptionUrl="./openapi.ja.yaml" router="hash" layout="sidebar"></elements-api>
  </main>
  <script>
    const el = document.getElementById('api');
    const flagsRoot = document.getElementById('lang');
    const flags = flagsRoot.querySelectorAll('.flag');
    const currentLang = /index\.en\.html$/.test(location.pathname) ? 'en' : 'ja';
    function setActive(lang){
      flags.forEach(b=>b.classList.toggle('active', b.dataset.lang===lang));
    }
    setActive(currentLang);
    el.setAttribute('apiDescriptionUrl', `./openapi.${currentLang}.yaml`);
    flagsRoot.addEventListener('click', (e)=>{
      const btn = e.target.closest('.flag');
      if(!btn) return;
      const lang = btn.dataset.lang;
      const hash = location.hash || '';
      const target = lang === 'en' ? 'index.en.html' : 'index.html';
      if (!location.pathname.endsWith(target)) {
        location.href = `${target}${hash}`;
        return;
      }
      el.setAttribute('apiDescriptionUrl', `./openapi.${lang}.yaml`);
      setActive(lang);
    });
  </script>
</body>
</html>

