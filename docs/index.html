<!doctype html>
<html lang="ja">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>IB‑Link ユーザーマニュアル</title>
	<link rel="preconnect" href="https://cdn.jsdelivr.net">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.9.0/styles/github.min.css">
<style>
		:root{
			--navy:#1e3a5f;
			--navy-dark:#0f2744;
			--navy-light:#2c4f7c;
			--bg:#ffffff;
			--sidebar-bg:#f5f7fa;
			--border:#d1d5db;
			--text:#1f2937;
			--text-light:#4b5563;
			--accent-hover:#e8f1f8;
		}
		html{scroll-behavior:smooth}
		body{
			margin:0;
			background:var(--bg);
			color:var(--text);
			font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Kaku Gothic ProN", "Noto Sans JP", Meiryo, system-ui, sans-serif;
			line-height:1.7;
			letter-spacing:0.01em;
		}
		/* Sidebar TOC */
		.toc{
			position:fixed;
			top:0;left:0;bottom:0;
			width:280px;
			background:var(--sidebar-bg);
			border-right:1px solid var(--border);
			overflow:auto;
			padding:20px 16px 24px 20px;
			box-shadow:2px 0 8px rgba(0,0,0,.03);
		}
		.toc .brand{
			display:flex;align-items:center;gap:10px;
			font-weight:700;font-size:15px;color:var(--navy-dark);
			padding:10px 6px 16px 6px;letter-spacing:.03em;
			border-bottom:2px solid var(--navy);
			margin-bottom:16px;
		}
		.toc .title{
			font-size:11px;font-weight:700;color:var(--text-light);
			text-transform:uppercase;letter-spacing:.1em;margin:12px 0 8px 4px;
		}
		.toc ul{list-style:none;margin:0;padding:0 4px 24px 4px}
		.toc li{margin:3px 0}
		.toc a{
			display:block;padding:8px 10px;border-radius:6px;text-decoration:none;
			color:var(--text);font-size:13.5px;transition:all .15s ease;
		}
		.toc a:hover{background:var(--accent-hover);color:var(--navy)}
		.toc a.active{background:var(--navy);color:#fff;font-weight:600;box-shadow:0 2px 4px rgba(30,58,95,.2)}
		.toc .lvl3{padding-left:16px;font-size:13px}
		/* Content */
		.container{
			margin-left:300px;
			max-width:1000px;
			padding:40px 32px 60px;
		}
		.container h1{
			font-size:32px;line-height:1.3;margin:0 0 24px;color:var(--navy-dark);
			font-weight:700;letter-spacing:-.01em;
		}
		.container h2{
			margin-top:36px;padding-top:20px;border-top:2px solid var(--border);
			color:var(--navy);font-weight:600;font-size:24px;letter-spacing:-.005em;
		}
		.container h3{
			margin-top:24px;color:var(--navy-light);font-weight:600;font-size:19px;
		}
		.container a{color:var(--navy);text-decoration:underline;text-decoration-color:var(--border);text-underline-offset:3px;transition:text-decoration-color .2s}
		.container a:hover{text-decoration-color:var(--navy)}
		.container p{margin:12px 0;color:var(--text)}
		.container ul, .container ol{margin:12px 0;padding-left:24px;color:var(--text)}
		.container li{margin:6px 0}
		pre{
			background:#fafbfc;border:1px solid var(--border);border-radius:8px;
			box-shadow:0 1px 3px rgba(0,0,0,.06);padding:18px;overflow:auto;
			font-size:13.5px;
		}
		code{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-size:13.5px}
		:not(pre) > code{background:#f3f4f6;padding:2px 6px;border-radius:4px;color:var(--navy-dark);font-size:13px}
		img{max-width:100%;height:auto;border-radius:6px;box-shadow:0 2px 8px rgba(0,0,0,.08);margin:16px 0}
		blockquote{
			border-left:4px solid var(--navy);background:#f9fafb;padding:12px 16px;margin:16px 0;
			color:var(--text-light);font-style:italic;
		}
		table{border-collapse:collapse;width:100%;margin:16px 0}
		th,td{border:1px solid var(--border);padding:10px 12px;text-align:left}
		th{background:var(--sidebar-bg);color:var(--navy);font-weight:600}
		/* Back to top */
		.back-to-top{
			position:fixed;right:20px;bottom:20px;background:var(--navy);color:#fff;
			border:none;border-radius:999px;padding:12px 16px;font-size:13px;font-weight:600;cursor:pointer;
			box-shadow:0 4px 12px rgba(30,58,95,.3);opacity:0;pointer-events:none;transition:all .25s ease;
		}
		.back-to-top.show{opacity:1;pointer-events:auto}
		.back-to-top:hover{background:var(--navy-dark);transform:translateY(-2px);box-shadow:0 6px 16px rgba(30,58,95,.4)}
		/* Responsive */
		@media (max-width:1024px){
			.toc{display:none}
			.container{margin-left:0;padding:24px 20px}
		}
</style>
	<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
</head>
<body>
	<nav class="toc">
		<div class="brand">IB‑Link ユーザーガイド</div>
		<div class="title">目次</div>
		<ul id="toc"></ul>
	</nav>
	<main id="app" class="container">
		<p>読み込み中…</p>
	</main>
	<button id="toTop" class="back-to-top" aria-label="Back to top">Top</button>
  <script>
		// Fetch and render Markdown
		const app = document.getElementById('app');
		const tocRoot = document.getElementById('toc');
		function slugify(s){
			return (s||'').toLowerCase()
				.replace(/[^a-z0-9\u3040-\u30ff\u4e00-\u9faf\s-]/g,'')
				.replace(/\s+/g,'-')
				.replace(/-+/g,'-')
				.substring(0,80);
		}
		function ensureHeadingIds(container){
			const hs = container.querySelectorAll('h2, h3');
			hs.forEach(h=>{
				if(!h.id){
					h.id = slugify(h.textContent.trim()) || ('sec-' + Math.random().toString(36).slice(2,8));
				}
			});
			return hs;
		}
		function buildToc(headings){
			tocRoot.innerHTML = '';
			headings.forEach(h=>{
				const li = document.createElement('li');
				if(h.tagName.toLowerCase()==='h3') li.className = 'lvl3';
				const a = document.createElement('a');
				a.href = '#' + h.id;
				a.textContent = h.textContent.replace(/\s+/g,' ').trim();
				li.appendChild(a);
				tocRoot.appendChild(li);
			});
			// Active highlight
			const links = tocRoot.querySelectorAll('a');
			const map = {};
			links.forEach(a=>{ map[a.getAttribute('href').slice(1)] = a; });
			const io = new IntersectionObserver(entries=>{
				entries.forEach(e=>{
					if(e.isIntersecting){
						const id = e.target.id;
						links.forEach(a=>a.classList.remove('active'));
						if(map[id]) map[id].classList.add('active');
					}
				});
			},{rootMargin:'0px 0px -70% 0px', threshold:0});
			headings.forEach(h=>io.observe(h));
		}
		async function render(){
			try{
				const res = await fetch('./index.md', {cache:'no-cache'});
				if(!res.ok) throw new Error('Failed to load index.md');
				const md = await res.text();
				// Render with marked
				marked.setOptions({
					highlight: function(code, lang){
						try{ return hljs.highlight(code, {language: lang || 'plaintext'}).value; }
						catch(_){ return hljs.highlightAuto(code).value; }
					},
					breaks: false,
					gfm: true
				});
				app.innerHTML = marked.parse(md);
				// Code blocks styling
				document.querySelectorAll('pre code').forEach(el=>hljs.highlightElement(el));
				// Build TOC
				const headings = ensureHeadingIds(app);
				buildToc(headings);
			}catch(e){
				app.innerHTML = '<p>Markdown の読み込みに失敗しました。ネットワークとパスを確認してください。</p>';
				console.error(e);
			}
		}
		render();
		// Back to top
		const toTop = document.getElementById('toTop');
		toTop.addEventListener('click', ()=>window.scrollTo({top:0, behavior:'smooth'}));
		window.addEventListener('scroll', ()=>{
			if(window.scrollY>600) toTop.classList.add('show');
			else toTop.classList.remove('show');
		});
	</script>
</body>
</html>


